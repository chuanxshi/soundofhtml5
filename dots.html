<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Sound of HTML5 - dots</title>
  <meta name="description" content="Sound of HTML5, CSS3 and JavaScript Audio API">
  <meta name="author" content="Shi Chuan">
  <link rel="stylesheet" href="css/style.css">
  <style>
  #graphPixels {
  margin:0 auto;
  width:520px; 
  height:20px; 
  margin-top:350px; 
  position:relative;
  }
  #graphPixels div {width:3px; height:3px; background:red; position:absolute; top:0; left:0;}
  #play {margin-right:15px; margin-left:160px;}
  #pause, #play {float:left;}
  #control {width:445px; height:200px;  margin:10px auto;}
  </style>
</head>
<body>
  <header><h1>Sound of HTML5</h1></header> <!-- end of header -->
  
  <section>
  <a href="../soundofhtml5/index.html">Home</a> -> dots
  <div id="graphPixels">
  </div>
  <div id="control">
    <div id="play" class="btn">play</div>
    <div id="pause" class="btn">pause</div>
  </div>
  </section> <!-- end of content -->
  
  <footer>by <a href="http://twitter.com/#!/shichuan">@shichuan</a></footer> <!-- end of footer -->
  
  <script src="script/soundmanager2-jsmin.js"></script>
  <script>
  var a='<div></div>';
  for (var i=0; i<256; i++) {
    a = a+'<div></div>';
  }
  document.getElementById('graphPixels').innerHTML=a;
  var graphPixels = document.getElementById('graphPixels').getElementsByTagName('div');

  var soundObject;
  function initSoundObject() {
    soundManager.flashVersion = 9;
    soundManager.url = 'swf/';
    soundManager.useHighPerformance = true;
    soundManager.debugMode = false; // disable debug mode
   
    // When soundmanager has finished loading, loud our mp3
    soundManager.onready(function() {
      // Ready to use; soundManager.createSound() etc. can now be called.
      soundObject = soundManager.createSound({
        id: 'mySound',
        url: 'demos.mp3',
        autoLoad: true,
        autoPlay: false,
        usePeakData: false,
        useWaveformData: false,
        useEQData: true,
        volume: 100
      });
      
      document.getElementById('pause').onclick = function () {
        soundObject.pause('mySound');
      }
      
      document.getElementById('play').onclick = function () {
        soundObject.play({
          whileplaying:function() {
            var gScale = 32;
            console.log("num: "+this.eqData.left[10]*gScale);
            var gPixels = document.getElementById('graphPixels').getElementsByTagName('div');
            for (var i=0; i<256; i++) {
              gPixels[i].style.top = (32-(gScale+Math.ceil(this.eqData.left[i]*gScale)))*5+'px';
              gPixels[i].style.left = i*2+'px';
            }
          }
        });
      }
    });
  }

  initSoundObject();
  </script>
  <a href="https://github.com/shichuan/soundofhtml5/tree/gh-pages"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://gs1.wac.edgecastcdn.net/80460E/assets/img/6429057dfef9e98189338d22e7f6646c6694f032/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub"></a>
</body>
</html>